@{
    ViewData["Title"] = "Імпорт квитків";
}

<div class="card">
    <div class="card-header">
        <h4><i class="fas fa-file-import me-2"></i>@ViewData["Title"]</h4>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <div class="mb-4">
                    <h5>Оберіть Excel-файл для завантаження квитків</h5>
                    @using (Html.BeginForm("Import", "Tickets", FormMethod.Post, new { enctype = "multipart/form-data", id = "frm-excel" }))
                    {
                        <div class="mb-3">
                            <p>Завантажте Excel-файл з даними про квитки:</p>
                            <input type="file" name="fileExcel" id="fileExcel" class="form-control" accept=".xlsx" />
                        </div>
                        <div class="mb-3">
                            <input type="submit" value="Завантажити" class="btn btn-primary" />
                            <a asp-action="Index" class="btn btn-secondary ms-2">Повернутися до списку</a>
                        </div>
                    }
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Вимоги до формату файлу</h5>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li>Файл повинен бути у форматі Excel (.xlsx)</li>
                            <li>Кожен лист у файлі відповідає певному типу квитка</li>
                            <li>Назва листа має відповідати назві типу квитка</li>
                            <li>Перший рядок має містити заголовки колонок</li>
                            <li>
                                Обов'язкові колонки:
                                <ul>
                                    <li>Поїзд (назва)</li>
                                    <li>Пасажир (ім'я)</li>
                                    <li>Електронна пошта</li>
                                    <li>Станція відправлення</li>
                                    <li>Станція прибуття</li>
                                    <li>Дата поїздки</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle me-2"></i>Примітка:</h5>
                <p>
                    Система автоматично створить відсутні записи для потягів, станцій і користувачів, якщо їх немає в базі даних.
                    Для нових користувачів обов'язково вказуйте їх повне ім'я та електронну пошту.
                </p>
            </div>
        </div>
    </div>
</div>